<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Gi·ªè h√†ng | Nghƒ©a STORE</title>

  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial}
    body{background:#f5f5f5}

    header{
      background:#fff;display:flex;justify-content:space-between;align-items:center;
      padding:15px 60px;box-shadow:0 2px 8px rgba(0,0,0,.08);
      position:sticky;top:0;z-index:10
    }
    .logo{font-size:24px;font-weight:700;color:#e53935}
    nav a{margin-left:25px;text-decoration:none;color:#333;font-weight:500}
    nav span{background:red;color:#fff;padding:2px 7px;border-radius:50%;font-size:12px}

    .wrap{
      max-width:1100px;margin:35px auto;background:#fff;border-radius:12px;
      padding:25px;box-shadow:0 8px 25px rgba(0,0,0,.08)
    }
    h2{margin-bottom:18px}

    table{width:100%;border-collapse:collapse}
    th,td{padding:14px;border-bottom:1px solid #eee;text-align:center}
    th{background:#f7f7f7;text-align:left}
    td:nth-child(1){text-align:left}
    .cart-img{
      width:60px;height:60px;object-fit:cover;border-radius:10px;
      vertical-align:middle;margin-right:10px
    }

    .qty{
      display:flex;align-items:center;justify-content:center;gap:10px
    }
    .qty button{
      width:32px;height:32px;border:none;border-radius:8px;
      background:#1976d2;color:#fff;font-weight:700;cursor:pointer
    }
    .qty button:hover{background:#0d47a1}

    .remove{
      color:#e53935;cursor:pointer;font-weight:600
    }

    .total{
      margin-top:18px;text-align:right;font-size:20px;font-weight:800
    }

    .empty{
      padding:30px 0;text-align:center;color:#666
    }
  </style>
</head>

<body>

<header>
  <div class="logo">Nghƒ©a STORE</div>
  <nav>
    <a href="index.html">Trang Ch·ªß</a>
    <a href="shop.html">S·∫£n Ph·∫©m</a>
    <a href="cart.html">Gi·ªè H√†ng <span id="cartCount">0</span></a>
  </nav>
</header>

<div class="wrap">
  <h2>üõí Gi·ªè h√†ng c·ªßa b·∫°n</h2>

  <table>
    <thead>
      <tr>
        <th>·∫¢nh / S·∫£n ph·∫©m</th>
        <th>Gi√°</th>
        <th>S·ªë l∆∞·ª£ng</th>
        <th>Th√†nh ti·ªÅn</th>
        <th>X√≥a</th>
      </tr>
    </thead>
    <tbody id="cartBody"></tbody>
  </table>

  <div class="total" id="totalText">T·ªïng c·ªông: 0‚Ç´</div>
  <div class="cart-actions">
    <a href="shop.html" class="btn-outline">‚Üê Ti·∫øp t·ª•c mua h√†ng</a>
    <button class="btn-checkout" onclick="checkout()">Thanh to√°n</button>
</div>

</div>

<script>
  // ======================
  // CART (ƒë√∫ng theo shop.html b·∫°n ƒëang d√πng)
  // item: { id, name, price, img, qty }
  // ======================
  function getCart(){
    return JSON.parse(localStorage.getItem("cart")) || [];
  }
  function saveCart(cart){
    localStorage.setItem("cart", JSON.stringify(cart));
  }
  function formatPrice(n){
    return (Number(n) || 0).toLocaleString("vi-VN") + "‚Ç´";
  }

  function updateCartCount(){
    const cart = getCart();
    const count = cart.reduce((s,i)=> s + (Number(i.qty) || 0), 0);
    const badge = document.getElementById("cartCount");
    if(badge) badge.textContent = count;
  }

  function renderCart(){
    const cart = getCart();
    const tbody = document.getElementById("cartBody");
    const totalText = document.getElementById("totalText");
    tbody.innerHTML = "";

    if(cart.length === 0){
      tbody.innerHTML = `<tr><td colspan="5" class="empty">Gi·ªè h√†ng tr·ªëng</td></tr>`;
      totalText.textContent = "T·ªïng c·ªông: 0‚Ç´";
      updateCartCount();
      return;
    }

    let total = 0;

    cart.forEach((item, index) => {
      const qty = Number(item.qty) || 1;
      const price = Number(item.price) || 0;
      const lineTotal = qty * price;
      total += lineTotal;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>
          <img class="cart-img" src="${item.img}" alt="">
          ${item.name || "S·∫£n ph·∫©m"}
        </td>
        <td>${formatPrice(price)}</td>
        <td>
          <div class="qty">
            <button onclick="changeQty(${index}, -1)">-</button>
            <span>${qty}</span>
            <button onclick="changeQty(${index}, 1)">+</button>
          </div>
        </td>
        <td>${formatPrice(lineTotal)}</td>
        <td><span class="remove" onclick="removeItem(${index})">X√≥a</span></td>
      `;
      tbody.appendChild(tr);
    });

    totalText.textContent = "T·ªïng c·ªông: " + formatPrice(total);
    updateCartCount();
  }

  function changeQty(index, delta){
    const cart = getCart();
    if(!cart[index]) return;

    cart[index].qty = (Number(cart[index].qty) || 1) + delta;

    if(cart[index].qty <= 0){
      cart.splice(index, 1);
    }

    saveCart(cart);
    renderCart();
  }

  function removeItem(index){
    const cart = getCart();
    cart.splice(index, 1);
    saveCart(cart);
    renderCart();
  }

  // init
  renderCart();
</script>
<script>
function checkout(){
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    if(cart.length === 0){
        alert("Gi·ªè h√†ng ƒëang tr·ªëng!");
        return;
    }

    alert("üéâ Thanh to√°n th√†nh c√¥ng!\nC·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng t·∫°i Nghƒ©a STORE.");

    localStorage.removeItem("cart");
    window.location.href = "index.html";
}
</script>

</body>
</html>
